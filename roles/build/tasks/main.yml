---
- name: Ensure facts are gathered
  ansible.builtin.include_tasks: gather-facts.yml

- name: Ensure workstation preflight validated
  ansible.builtin.include_role:
    name: "{{ preflight_item.name }}"
    public: true
    tasks_from: preflight
  when: preflight_item.preflight
  loop_control:
    loop_var: preflight_item
  loop: "{{ ws_roles }}"

- name: Ensure workstation role build
  ansible.builtin.include_role:
    name: "{{ build_item }}"
    public: true
  loop_control:
    loop_var: build_item
  loop: "{{ ws_roles }}"
